library("Seurat")
library("ggplot2")
library("DESeq2")
library("dplyr")
library("MAST")
library(tidyverse)
library(ggpubr)
library(tidymodels)
library(tidyverse)
library(Seurat)
library(scales)
library(viridis)
library(Matrix)
library(rsample)
library(parsnip)
library(yardstick)
library(janitor)
library(riskyr)
library(pheatmap)
library(slingshot)
library(circlize)
library(tidyverse)
library(ggpubr)
library(remotes)
library(cerebroApp)
library(msigdbr)
library(tamlabscpipeline)
library(fgsea)
library(scater)
library(Seurat)
library(cowplot)
library(SeuratDisk)
library(SeuratData)
library(patchwork)
library(SingleCellExperiment)
library(loomR)

#必须要安装这个版本的seuratdisk:seurat-disk@dae280a
#object@meta.data里面必须没有dataframe！！
remotes::install_github("mojaveazure/seurat-disk@dae280a")
test_2 <- mono.obj.all_rename
test_2@meta.data$singler.annot <- NULL
SaveH5Seurat(test_2, overwrite=TRUE,filename = "mono.obj.all_rename.h5Seurat")
Convert("mono.obj.all_rename.h5Seurat", dest = "h5ad", overwrite=TRUE)
a <- mono.obj.all_rename@assays[["RNA"]]@scale.data
a <- as.data.frame(a)
test <- a %>% rownames_to_column("gene") %>% filter(gene=="HES4") %>% column_to_rownames("gene")
average(test)
